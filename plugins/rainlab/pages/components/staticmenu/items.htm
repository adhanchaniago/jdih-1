{% for item in items if not item.viewBag.isHidden %}
    {% if item.items %}
        <li class="menu-item-has-children">
            {% if item.url %}
                <a href="{{ item.url }}" {{ item.viewBag.isExternal ? 'target="_blank"' }}>
                    {{ item.title }}
                </a>
            {% else %}
                <span>{{ item.title }}</span>
            {% endif %}

            {% if item.items %}
                <ul class="submenu">{% partial __SELF__ ~ "::items" items=item.items %}</ul>
            {% endif %}
        </li>
    {% else %}
        <li class="{{ item.isActive ? 'home' : '' }} {{ item.isChildActive ? 'child-active' : '' }} {{ item.viewBag.cssClass }}">
            {% if item.url %}
                <a href="{{ item.url }}" {{ item.viewBag.isExternal ? 'target="_blank"' }}>
                    {{ item.title }}
                </a>
            {% else %}
                <span>{{ item.title }}</span>
            {% endif %}

            {% if item.items %}
                <ul>{% partial __SELF__ ~ "::items" items=item.items %}</ul>
            {% endif %}
        </li>
    {% endif %}
{% endfor %}